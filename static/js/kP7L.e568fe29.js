(window.webpackJsonp=window.webpackJsonp||[]).push([["kP7L"],{kP7L:function(t,e,o){"use strict";o.r(e);var a="http://10.10.12.252:8080/api/v1",s={name:"App",filters:{formatStatus:function(t){return{BLOCKED:"运行",COMPLETE:"完成",ERROR:"错误",NONE:"未知",NORMAL:"正常",PAUSED:"暂停"}[t]}},data:function(){var t=this;return{rule:{jobName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],jobGroup:[{required:!0,message:"请输入任务所在分组",trigger:"blur"}],jobClassName:[{required:!0,message:"请输入任务类名",trigger:"blur"},{validator:function(e,o,s){t.$http.post(a+"/valid/cls",{clsName:o},{emulateJSON:!0}).then(function(t){if(0===t.data.code)return s(new Error("类错误"));s()})},trigger:"blur"}],cronExpression:[{required:!0,message:"请选择间隔时间",trigger:"change"}]},statusOptions:[{value:"BLOCKED",label:"运行"},{value:"COMPLETE",label:"完成"},{value:"ERROR",label:"错误"},{value:"NONE",label:"未知"},{value:"NORMAL",label:"正常"},{value:"PAUSED",label:"暂停"}],options2:[{value:null,label:""},{value:"0 0/5 * * * ? *",label:"5分钟"},{value:"0 0/10 * * * ? ",label:"10分钟"},{value:"0 0/30 * * * ? *",label:"30分钟"},{value:"0 0 * * * ? *",label:"60分钟"}],mmyData:[],myData:[],mymyData:[],formData:{jobName:"",jobGroup:"",cronExpression:"",dr:"",jobStatus:"",jobDescription:"",jobClassName:"",jobid:""},nowIndex:-100,count:0,minutes:"",selectIndex:0,myListener:0,oldJobName:[],oldJobGroup:[],code:0,page:1,rows:5,total:1}},watch:{mymyData:function(t,e){this.myData=this.mymyData},myListener:function(){var t=this;this.selectByCondition(),setTimeout(function(){t.selectByCondition()},500)},deep:!0},created:function(){this.selectByCondition()},methods:{handleSizeChange:function(t){this.rows=t,this.selectByCondition()},handleCurrentChange:function(t){this.page=t,this.selectByCondition()},selectByCondition:function(){this.oldJobName=[],this.oldJobGroup=[],this.$http.post(a+"/job/queryJob",{page:this.page,rows:this.rows,jobName:this.formData.jobName,jobGroup:this.formData.jobGroup,jobStatus:this.formData.jobStatus,cronExpression:this.formData.cronExpression,description:this.formData.jobDescription,jobClassName:this.formData.jobClassName},{emulateJSON:!0}).then(function(t){this.code=t.data.code,this.total=t.data.data.total;var e=t.data.data.list;this.mymyData=[];for(var o=0;o<e.length;o++)this.oldJobName.push(e[o].jobName),this.oldJobGroup.push(e[o].jobGroup),null!==e[o].cronExpression&&("PAUSED"===e[o].jobStatus?this.mymyData.push({jobName:e[o].jobName,jobGroup:e[o].jobGroup,cronExpression:e[o].cronExpression,dr:!1,jobStatus:e[o].jobStatus,jobDescription:e[o].description,jobClassName:this.classOfJob(e[o].jobClassName),jobId:e[o].jobId}):this.mymyData.push({jobName:e[o].jobName,jobGroup:e[o].jobGroup,cronExpression:e[o].cronExpression,dr:!0,jobStatus:e[o].jobStatus,jobDescription:e[o].description,jobClassName:this.classOfJob(e[o].jobClassName),jobId:e[o].jobId}))},function(t){alert(t.status+"查询任务失败了")})},myCancel:function(t){this.addMyListener()},changeCron:function(t){this.$http.post(a+"/job/saveOrUpdate",{oldJobName:this.oldJobName[this.selectIndex],oldJobGroup:this.oldJobGroup[this.selectIndex],jobId:this.myData[this.selectIndex].jobId,jobName:this.myData[this.selectIndex].jobName,jobGroup:this.myData[this.selectIndex].jobGroup,cronExpression:t,description:this.myData[this.selectIndex].jobDescription},{emulateJSON:!0})},getSelectIndex:function(t){this.selectIndex=t},strSplite:function(t){var e=t.split(" ")[1].split("/");1===e.length?this.minutes=60:this.minutes=e[1]},changeStatus:function(t,e){t?this.myResume(e):this.myPause(e)},open:function(t){var e=this;setTimeout(function(){e.open4()},500)},open2:function(t){var e=this;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteMsg(t),setTimeout(function(){e.open3()},500)}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},open3:function(){2e4===this.code?(this.$message({type:"success",message:"删除成功!"}),this.addMyListener()):this.$message({type:"info",message:"删除失败!"})},open4:function(){2e4===this.code?this.$message("操作成功"):this.$message("操作失败")},runOnce:function(t){this.code=404;var e=this.myData[t].jobName,o=this.myData[t].jobGroup;this.$http.post(a+"/job/runJob",{jobName:e,jobGroup:o},{emulateJSON:!0}).then(function(t){this.code=t.data.code},function(t){this.code=t.data.code}),this.open(),this.addMyListener()},trans:function(t){return{"5分钟":"0 0/5 * * * ? *","15分钟":"0 0/15 * * * ? *","30分钟":"0 0/3 * * * ? *","60分钟":"0 0 * * * ? *"}[t]},edit:function(t,e){var o=this;this.code=404,this.$http.post(a+"/job/saveOrUpdate",{oldJobName:this.oldJobName[e],oldJobGroup:this.oldJobGroup[e],jobId:this.myData[e].jobId,jobName:this.myData[e].jobName,jobGroup:this.myData[e].jobGroup,description:this.myData[e].jobDescription,cronExpression:this.myData[e].cronExpression},{emulateJSON:!0}).then(function(t){this.code=t.data.code},function(t){this.code=t.data.code}),setTimeout(function(){o.addMyListener()},500),this.open()},classOfJob:function(t){var e=t.split(".");return e[e.length-1]},myResume:function(t){this.code=404;var e=this.myData[t].jobName,o=this.myData[t].jobGroup;this.$http.post(a+"/job/resumeJob",{jobName:e,jobGroup:o},{emulateJSON:!0}).then(function(t){this.code=t.data.code},function(t){this.code=t.data.code}),this.addMyListener()},myPause:function(t){this.code=404;var e=this.myData[t].jobName,o=this.myData[t].jobGroup;this.$http.post(a+"/job/pauseJob",{jobName:e,jobGroup:o},{emulateJSON:!0}).then(function(t){this.code=t.data.code},function(t){this.code=t.data.code}),this.addMyListener()},add:function(t){var e=this;this.code=404,this.$refs[t].validate(function(t){if(!t)return!1;e.$http.post(a+"/job/saveOrUpdate",{jobName:e.formData.jobName,jobGroup:e.formData.jobGroup,jobStatus:e.formData.jobStatus,cronExpression:e.formData.cronExpression,description:e.formData.jobDescription,jobClassName:e.formData.jobClassName},{emulateJSON:!0}).then(function(t){this.code=t.data.code},function(t){this.code=t.data.code}),e.formData.jobName="",e.formData.jobGroup="",e.formData.cronExpression="",e.formData.jobStatus="",e.formData.jobDescription="",e.formData.jobClassName="",e.addMyListener(),e.open()})},addMyListener:function(){this.myListener=this.myListener+1},deleteMsg:function(t){this.code=404;var e=this.myData[t].jobName,o=this.myData[t].jobGroup;this.$http.post(a+"/job/deleteJob",{oldJobName:e,oldJobGroup:o},{emulateJSON:!0}).then(function(t){this.code=t.data.code},function(t){this.code=t.data.code})},addTask:function(){this.count++},getJobInfos:function(){this.$http.post(a+"/job/queryJob",{page:this.page,rows:this.rows},{emulateJSON:!0}).then(function(t){this.total=t.data.data.total;var e=t.data.data.list;this.mymyData=[];for(var o=0;o<e.length;o++)this.oldJobName.push(e[o].jobName),this.oldJobGroup.push(e[o].jobGroup),null!==e[o].cronExpression&&(this.strSplite(e[o].cronExpression),"PAUSED"===e[o].jobStatus?this.mymyData.push({jobName:e[o].jobName,jobGroup:e[o].jobGroup,cronExpression:e[o].cronExpression,dr:!1,jobStatus:e[o].jobStatus,jobDescription:e[o].description,jobClassName:this.classOfJob(e[o].jobClassName),jobId:e[o].jobId}):this.mymyData.push({jobName:e[o].jobName,jobGroup:e[o].jobGroup,cronExpression:e[o].cronExpression,dr:!0,jobStatus:e[o].jobStatus,jobDescription:e[o].description,jobClassName:this.classOfJob(e[o].jobClassName),jobId:e[o].jobId}))},function(t){alert(t.status+"查询任务出现错误")})}}},n=o("ZrdR"),i=Object(n.a)(s,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("el-form",{ref:"formData",attrs:{rules:t.rule,inline:!0,model:t.formData,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"任务名称",prop:"jobName"}},[o("el-input",{model:{value:t.formData.jobName,callback:function(e){t.$set(t.formData,"jobName",e)},expression:"formData.jobName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"所在分组",prop:"jobGroup"}},[o("el-input",{model:{value:t.formData.jobGroup,callback:function(e){t.$set(t.formData,"jobGroup",e)},expression:"formData.jobGroup"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"任务类名",prop:"jobClassName"}},[o("el-input",{model:{value:t.formData.jobClassName,callback:function(e){t.$set(t.formData,"jobClassName",e)},expression:"formData.jobClassName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"间隔时间",prop:"cronExpression"}},[o("el-select",{model:{value:t.formData.cronExpression,callback:function(e){t.$set(t.formData,"cronExpression",e)},expression:"formData.cronExpression"}},t._l(t.options2,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),o("el-form-item",{attrs:{label:"任务描述",prop:"jobDescription"}},[o("el-input",{model:{value:t.formData.jobDescription,callback:function(e){t.$set(t.formData,"jobDescription",e)},expression:"formData.jobDescription"}})],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-left":"1170px"}},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.selectByCondition()}}},[t._v("查询")])],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.add("formData")}}},[t._v("添加任务")])],1)],1),t._v(" "),o("el-editable",{ref:"editable",staticClass:"manual-table1",staticStyle:{width:"100%"},attrs:{data:t.myData,"edit-config":{trigger:"click",mode:"row",isTabKey:!0},"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{"update:data":function(e){t.myData=e}}},[o("el-editable-column",{attrs:{"edit-render":{name:"ElInput"},prop:"jobName",align:"center",label:"任务名称",width:"225","show-overflow-tooltip":""}}),t._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElInput"},prop:"jobGroup",align:"center",label:"所在分组",width:"80","show-overflow-tooltip":""}}),t._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElInput"},prop:"jobClassName",align:"center",label:"任务类名",width:"145","show-overflow-tooltip":""}}),t._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElSelect",options:t.options2},prop:"cronExpression",align:"center",label:"间隔时间",width:"120","show-overflow-tooltip":""}}),t._v(" "),o("el-editable-column",{attrs:{align:"center",label:"任务状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(t._f("formatStatus")(t.myData[e.$index].jobStatus)))])]}}])}),t._v(" "),o("el-editable-column",{attrs:{"edit-render":{name:"ElInput"},prop:"jobDescription",align:"center",label:"任务描述",width:"255","show-overflow-tooltip":""},on:{click:function(e){t.giveValue(t.scope.$index)}}}),t._v(" "),o("el-editable-column",{attrs:{align:"center",label:"操作",width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{plain:!0,type:"primary",size:"small"},on:{click:function(o){t.runOnce(e.$index)}}},[t._v("执行一次")]),t._v(" "),o("el-button",{attrs:{plain:!0,type:"warning",size:"small"},on:{click:function(o){t.edit(e.row,e.$index)}}},[t._v("修改")]),t._v(" "),o("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(o){t.open2(e.$index)}}},[t._v("删除")])]}}])}),t._v(" "),o("el-editable-column",{attrs:{"class-name":"status-col",label:"是否暂停",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",{on:{click:function(o){t.changeStatus(t.myData[e.$index].dr,e.$index),t.open()}}},[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":""},model:{value:t.myData[e.$index].dr,callback:function(o){t.$set(t.myData[e.$index],"dr",o)},expression:"myData[scope.$index].dr"}})],1)]}}])})],1),t._v(" "),o("el-pagination",{attrs:{"current-page":t.page,"page-sizes":[5,10,20,50],"page-size":t.rows,total:t.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){t.page=e},"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)},[],!1,null,null,null);i.options.__file="index.vue";e.default=i.exports}}]);